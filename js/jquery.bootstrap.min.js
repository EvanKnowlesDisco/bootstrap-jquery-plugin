/**
* jquery.bootstrap.js
Copyright (c) Kris Zhang <kris.newghost@gmail.com>
License: MIT (https://github.com/newghost/bootstrap-jquery-plugin/blob/master/LICENSE)
*/
String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return typeof e[n]!="undefined"?e[n]:t})}),function(e){e.fn.dialog=function(t){var n=this,r=e(n),i=e(document.body),s=r.closest(".dialog"),o="dialog-parent",u=arguments[1],a=arguments[2],f=function(){var t='<div class="dialog modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close">&times;</button><h4 class="modal-title"></h4></div><div class="modal-body"></div><div class="modal-footer"></div></div></div></div>';s=e(t),e(document.body).append(s),s.find(".modal-body").append(r)},l=function(r){var i=(r||t||{}).buttons||{},o=s.find(".modal-footer");o.empty();var u=i.constructor==Array;for(var a in i){var f=i[a],l="",c="",h="btn-default",p="";if(f.constructor==Object)l=f.id,c=f.text,h=f["class"]||f.classed||h,p=f.click;else{if(!!u||f.constructor!=Function)continue;c=a,p=f}$button=e('<button type="button" class="btn">').addClass(h).html(c),l&&$button.attr("id",l),p&&function(e){$button.click(function(){e.call(n)})}(p),o.append($button)}o.data("buttons",i)},c=function(){s.modal("show")},h=function(e){s.modal("hide").one("hidden.bs.modal",function(){e&&(r.data(o).append(r),s.remove())})};t.constructor==Object&&(!r.data(o)&&r.data(o,r.parent()),s.size()<1&&f(),l(),e(".modal-title",s).html(t.title||""),e(".modal-dialog",s).addClass(t.dialogClass||""),e(".modal-header .close",s).click(function(){var e=t.onClose||h;e.call(n)}),(t["class"]||t.classed)&&s.addClass(t["class"]||t.classed),t.autoOpen!==!1&&c()),t=="destroy"&&h(!0),t=="close"&&h(),t=="open"&&c();if(t=="option"&&u=="buttons"){if(!a)return s.find(".modal-footer").data("buttons");l({buttons:a}),c()}return n}}(jQuery),$.messager=function(){var e=function(e,t){var n=$.messager.model;arguments.length<2&&(t=e||"",e="&nbsp;"),$("<div>"+t+"</div>").dialog({title:e,onClose:function(){$(this).dialog("destroy")},buttons:[{text:n.ok.text,classed:n.ok.classed||"btn-success",click:function(){$(this).dialog("destroy")}}]})},t=function(e,t,n){var r=$.messager.model;$("<div>"+t+"</div>").dialog({title:e,onClose:function(){$(this).dialog("destroy")},buttons:[{text:r.ok.text,classed:r.ok.classed||"btn-success",click:function(){$(this).dialog("destroy"),n&&n()}},{text:r.cancel.text,classed:r.cancel.classed||"btn-danger",click:function(){$(this).dialog("destroy")}}]})},n='<div class="dialog modal fade msg-popup"><div class="modal-dialog modal-sm"><div class="modal-content"><div class="modal-body text-center"></div></div></div></div>',r,i,s=function(e){r||(r=$(n),$("body").append(r)),r.find(".modal-body").html(e),r.modal({show:!0,backdrop:!1}),clearTimeout(i),i=setTimeout(function(){r.modal("hide")},1500)};return{alert:e,popup:s,confirm:t}}(),$.messager.model={ok:{text:"OK",classed:"btn-success"},cancel:{text:"Cancel",classed:"btn-danger"}},function(e){e.fn.datagrid=function(t,n){var r=this,i=e(r),s=i.data("config")||{},o=i.data("rows")||[],u=s.selectedClass||"success",a=function(t){var n=s.selectChange,r=s.singleSelect,a=s.edit,f=function(t){var s=e(this),a=s.hasClass(u),f=e("tbody tr",i).index(s),l=o[f]||{};r&&e("tbody tr",i).removeClass(u),s.toggleClass(u),n&&n(!a,f,l,s)};(n||typeof r!="undefined")&&t.click(f);var l=function(t){var n=e(this),r=n.closest("tr"),s=e("tbody tr",i).index(r),u=o[s]||{},a=n.attr("name");a&&(u[a]=n.val())};a&&t.find("input").keyup(l)},f=function(e,t){var n="<tr>";for(var r=0,i=e[0].length;r<i;r++){var o=e[0][r],u=o.formatter,a=o.field,f=o.tip,l=t[a],c=o.maxlength,h=o.readonly;typeof l=="undefined"&&(l=""),s.edit&&(c=c?' maxlength="{0}"'.format(o.maxlength):"",h=h?' readonly="readonly"':"",l='<input name="{0}" value="{1}" class="form-control"{2}{3}/>'.format(o.field,l,c,h)),l=u?u(t[a],t):l,n=n+"<td>"+l+"</td>"}return n+="</tr>",n},l=function(t){if(!n)return;var r=s.columns,o=n.rows||n,u="<tbody>";if(o)for(var l=0,c=o.length;l<c;l++)u+=f(r,o[l]);u+="</tbody>",e("tbody",i).remove(),i.data("rows",o).append(u),s.edit&&i.addClass("edit"),a(e("tbody tr",i))},c=function(){if(n&&typeof n.index!="undefined")return[n.index];var t=[];return i.find("tbody tr").each(function(n){var r=e(this);r.hasClass(u)&&t.push(n)}),t};if(t&&t.constructor==Object){var h=t.columns;if(h){e("thead",i).size()<1&&i.append("<thead></thead>");var p="<tr>";for(var d=0,v=h[0].length;d<v;d++){var m=h[0][d];p+="<th>"+(m.title||"")+"</th>"}p+="</tr>",i.data("config",t),e("thead",i).html(p)}}t=="loadData"&&l();if(t=="getData")return o;if(t=="getConfig")return s;if(t=="getColumns")return s.columns;t=="unselectRow"&&(typeof n!="undefined"?e("tbody tr",i).eq(n).removeClass(u):e("tbody tr",i).removeClass(u));if(t=="updateRow"){var g=c(),y=n.row,h=s.columns;for(var d=0,v=g.length;d<v;d++){var b=g[d];o&&(y=e.extend(o[b],y));var w=e(f(h,y,s));typeof n.index=="undefined"&&w.addClass(u),e("tbody tr",i).eq(b).after(w).remove(),a(w)}}if(t=="getSelections"){var E=[];return e("tbody tr",i).each(function(t){e(this).hasClass(u)&&E.push(o[t])}),E}if(t=="getSelectedIndex")return c();if(t=="insertRow"){var S=c()[0],y=n.row;if(typeof S=="undefined"||S<0)return;if(!s||!y)return i;var x=e("tbody tr",i),w=e(f(s.columns,y,s)),T=x.eq(S);a(w),T.size()?T.before(w):e("tbody",i).append(w),o.splice(S,0,y)}if(t=="deleteRow"){var g=typeof n=="number"?[n]:c();for(var d=g.length-1;d>-1;d--){var S=g[d];e("tbody tr",i).eq(S).remove(),o.splice(S,1)}}return r}}(jQuery),function(e){e.fn.tree=function(t,n){var r=this,i=e(r),s=Array.prototype.push,o="glyphicon-file",u="glyphicon-folder-open",a="glyphicon-folder-close",f=function(e,t,n){var r=[];!t&&r.push('<ul style="display:{0}">'.format(n=="close"?"none":"block"));for(var i=0,l=e.length;i<l;i++){var c=e[i],h=c.children,p=c.id,d=c.state,v=c.attributes;r.push("<li>");var m=typeof h=="undefined"?o:d=="close"?a:u;r.push('<span class="glyphicon {0}"></span> '.format(m)),r.push("<a{1}{2}{3}>{0}</a>".format(c.text,h?" class='tree-node'":"",p?" data-id='{0}'".format(p):"",v?" data-attr='{0}'".format(JSON.stringify(v)):"")),h&&s.apply(r,f(h,!1,d)),r.push("</li>")}return!t&&r.push("</ul>"),r},l=function(){e("span.glyphicon-folder-open, span.glyphicon-folder-close",i).click(function(t){var n=e(this),r=n.closest("li").children("ul");n.hasClass(a)?(n.removeClass(a).addClass(u),r.show()):(n.removeClass(u).addClass(a),r.hide())})};if(t&&t.constructor==Object){var c=t.data;if(c&&c.constructor==Array){var h=f(c,!0);i.html(h.join("")),i.data("config",t),l()}var p=t.onClick;p&&e("li>a",i).click(function(){var t=e(this);attrs=t.attr("data-attr"),p.call(r,{id:t.attr("data-id"),attributes:attrs?JSON.parse(attrs):{},text:t.text()},t)})}return r}}(jQuery)